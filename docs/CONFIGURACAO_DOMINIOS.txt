=============================================================================
CONFIGURA√á√ÉO DE DOM√çNIOS CUSTOMIZADOS
=============================================================================

VIS√ÉO GERAL:
Sistema permite 3 formas de acesso ao cat√°logo:
1. Slug Tradicional: app.aoseudispor.com.br/catalog/mirazzi
2. Subdom√≠nio Gratuito: mirazzi.aoseudispor.com.br
3. Dom√≠nio Pr√≥prio: www.mirazzi.com.br

=============================================================================
OP√á√ÉO 1: SLUG TRADICIONAL (Padr√£o)
=============================================================================

CONFIGURA√á√ÉO:
- J√° funciona automaticamente
- N√£o requer configura√ß√£o adicional
- URL: app.aoseudispor.com.br/catalog/[seu-slug]

VANTAGENS:
‚úÖ Funciona imediatamente
‚úÖ Sem configura√ß√£o de DNS
‚úÖ SSL autom√°tico
‚úÖ Sem custo

DESVANTAGENS:
‚ùå URL longa
‚ùå Menos profissional
‚ùå N√£o personaliz√°vel

=============================================================================
OP√á√ÉO 2: SUBDOM√çNIO GRATUITO
=============================================================================

PASSO A PASSO:

1. ESCOLHER SUBDOM√çNIO:
   - Acesse: Admin > Configura√ß√µes > Dom√≠nios
   - Digite o subdom√≠nio desejado (ex: "mirazzi")
   - Clique em "Verificar" para confirmar disponibilidade
   
   Regras:
   - Apenas letras min√∫sculas, n√∫meros e h√≠fen
   - M√≠nimo 3 caracteres
   - N√£o pode come√ßar/terminar com h√≠fen
   - Reservados: www, app, admin, api, mail, ftp, blog, shop, store

2. ATIVAR SUBDOM√çNIO:
   - Marque o switch "Habilitar Subdom√≠nio"
   - Selecione modo "Subdom√≠nio" nos radio buttons
   - Clique em "Salvar"

3. VALIDA√á√ÉO AUTOM√ÅTICA:
   - DNS wildcard j√° est√° configurado
   - SSL √© autom√°tico via Let's Encrypt
   - Cat√°logo fica dispon√≠vel imediatamente em:
     https://[seu-subdominio].aoseudispor.com.br

4. TESTAR:
   - Abra o link gerado em aba an√¥nima
   - Deve carregar seu cat√°logo diretamente
   - Verifique se SSL est√° ativo (cadeado verde)

VANTAGENS:
‚úÖ Gratuito
‚úÖ Configura√ß√£o simples (2 minutos)
‚úÖ SSL autom√°tico
‚úÖ URL profissional
‚úÖ Sem necessidade de dom√≠nio pr√≥prio

DESVANTAGENS:
‚ùå Limitado ao dom√≠nio .aoseudispor.com.br
‚ùå Menos flex√≠vel que dom√≠nio pr√≥prio

=============================================================================
OP√á√ÉO 3: DOM√çNIO PR√ìPRIO
=============================================================================

REQUISITOS PR√âVIOS:
- Ter um dom√≠nio registrado (ex: mirazzi.com.br)
- Acesso ao painel DNS do dom√≠nio (Registro.br, GoDaddy, etc)
- Acesso SSH ao servidor (para SSL)

---

PASSO 1: CONFIGURAR DOM√çNIO NO ADMIN
-------------------------------------
1. Acesse: Admin > Configura√ß√µes > Dom√≠nios
2. Digite seu dom√≠nio completo (ex: www.mirazzi.com.br)
3. Clique em "Gerar Token"
4. Copie o token gerado

---

PASSO 2: CONFIGURAR DNS
-----------------------

A. Registro TXT (Verifica√ß√£o):
   Tipo: TXT
   Nome: _vendmais-verification
   Valor: [token copiado acima]
   TTL: 3600 (ou padr√£o)

B. Registro CNAME ou A (Apontamento):
   
   OP√á√ÉO A - CNAME (Recomendado):
   Tipo: CNAME
   Nome: www (ou @ para dom√≠nio raiz)
   Valor: app.aoseudispor.com.br
   TTL: 3600

   OP√á√ÉO B - Registro A:
   Tipo: A
   Nome: www (ou @ para dom√≠nio raiz)
   Valor: [IP do servidor - consulte suporte]
   TTL: 3600

C. Aguardar Propaga√ß√£o:
   - DNS leva 5-60 minutos para propagar
   - Use https://dnschecker.org para verificar
   - Procure pelo registro TXT em _vendmais-verification.[seu-dominio]

---

PASSO 3: VERIFICAR NO ADMIN
----------------------------
1. Aguarde 10-60 minutos (propaga√ß√£o DNS)
2. Volte em: Admin > Configura√ß√µes > Dom√≠nios
3. Clique em "Verificar DNS"
4. ‚úÖ Deve aparecer: "Dom√≠nio verificado com sucesso!"

Se falhar:
- Aguarde mais tempo (DNS pode demorar at√© 24h em casos raros)
- Verifique se registros foram adicionados corretamente
- Use dig/nslookup para debug:
  dig TXT _vendmais-verification.www.mirazzi.com.br

---

PASSO 4: CONFIGURAR SSL (HTTPS)
--------------------------------

M√âTODO: Let's Encrypt com Certbot

A. Instalar Certbot (se n√£o instalado):
   Ubuntu/Debian:
   sudo apt update
   sudo apt install certbot python3-certbot-nginx

   CentOS/RHEL:
   sudo yum install certbot python3-certbot-nginx

B. Gerar Certificado:
   sudo certbot --nginx -d www.mirazzi.com.br

C. Certificado √© gerado automaticamente:
   - Certbot detecta Nginx
   - Configura SSL automaticamente
   - Redireciona HTTP ‚Üí HTTPS
   - Renova√ß√£o autom√°tica configurada

D. Testar:
   - Acesse: https://www.mirazzi.com.br
   - Deve carregar com cadeado verde
   - Certificado v√°lido por 90 dias (renova√ß√£o autom√°tica)

E. Renova√ß√£o Autom√°tica:
   # Certbot adiciona cron job automaticamente
   # Testar renova√ß√£o:
   sudo certbot renew --dry-run

---

PASSO 5: ATIVAR NO ADMIN
-------------------------
1. Volte em: Admin > Configura√ß√µes > Dom√≠nios
2. Marque switch "Habilitar Dom√≠nio Pr√≥prio"
3. Selecione modo "Dom√≠nio Pr√≥prio" nos radio buttons
4. Clique em "Salvar"
5. ‚úÖ Cat√°logo ficar√° dispon√≠vel em: https://www.mirazzi.com.br

---

VANTAGENS:
‚úÖ Marca pr√≥pria (www.sualoja.com.br)
‚úÖ M√°xima profissionalidade
‚úÖ SEO otimizado
‚úÖ Credibilidade aumentada
‚úÖ Controle total

DESVANTAGENS:
‚ùå Requer dom√≠nio pr√≥prio (custo)
‚ùå Configura√ß√£o mais complexa
‚ùå Requer acesso SSH para SSL
‚ùå Valida√ß√£o obrigat√≥ria

=============================================================================
TROUBLESHOOTING
=============================================================================

PROBLEMA: Subdom√≠nio n√£o est√° dispon√≠vel
-----------------------------------------
Causa: Outro cliente j√° est√° usando
Solu√ß√£o: Escolha outro subdom√≠nio

PROBLEMA: Verifica√ß√£o DNS falha
--------------------------------
Causas poss√≠veis:
1. DNS ainda n√£o propagou (aguarde mais)
2. Registro TXT n√£o foi adicionado corretamente
3. Registro TXT tem valor errado

Debug:
# Linux/Mac
dig TXT _vendmais-verification.www.seudominio.com.br

# Windows
nslookup -type=TXT _vendmais-verification.www.seudominio.com.br

# Online
https://dnschecker.org

Solu√ß√£o:
1. Verifique registros no painel DNS
2. Copie token novamente (sem espa√ßos)
3. Aguarde mais tempo
4. Teste com ferramenta online

PROBLEMA: SSL n√£o funciona
--------------------------
Causas:
1. Certbot n√£o instalado
2. Nginx n√£o configurado
3. Portas 80/443 bloqueadas

Solu√ß√£o:
sudo certbot --nginx -d seudominio.com.br --dry-run
# Se falhar, verifique:
sudo nginx -t
sudo systemctl status nginx
sudo ufw status

PROBLEMA: Cat√°logo n√£o carrega em dom√≠nio pr√≥prio
--------------------------------------------------
Checklist:
1. ‚úÖ Dom√≠nio verificado? (badge verde no admin)
2. ‚úÖ Switch "Habilitar Dom√≠nio Pr√≥prio" marcado?
3. ‚úÖ Modo selecionado: "Dom√≠nio Pr√≥prio"?
4. ‚úÖ Salvou as configura√ß√µes?
5. ‚úÖ DNS aponta para servidor correto?
6. ‚úÖ SSL configurado?

PROBLEMA: SSL em subdom√≠nio
----------------------------
Subdom√≠nios usam certificado wildcard autom√°tico.
Se n√£o funcionar:
1. Verifique se *.aoseudispor.com.br tem certificado
2. Contate suporte t√©cnico

PROBLEMA: Erro "Loja n√£o encontrada"
-------------------------------------
Causas:
1. Subdom√≠nio/dom√≠nio n√£o salvo no banco
2. Switch n√£o est√° ativado
3. Modo errado selecionado

Solu√ß√£o:
1. Verifique configura√ß√µes salvas
2. Teste com slug primeiro (sempre funciona)
3. Recarregue p√°gina admin
4. Tente salvar novamente

=============================================================================
M√öLTIPLOS DOM√çNIOS
=============================================================================

CEN√ÅRIO: Quero que cat√°logo funcione em TODAS as URLs

SOLU√á√ÉO:
Mantenha todas as op√ß√µes configuradas simultaneamente:
1. Slug: Sempre dispon√≠vel (n√£o pode desativar)
2. Subdom√≠nio: Configure e ative
3. Dom√≠nio pr√≥prio: Configure e ative

Selecione o "Modo de Acesso" conforme prefer√™ncia:
- "Slug": Links compartilhados usar√£o app.aoseudispor.com.br/catalog/xxx
- "Subdom√≠nio": Links compartilhados usar√£o xxx.aoseudispor.com.br
- "Dom√≠nio Pr√≥prio": Links compartilhados usar√£o www.xxx.com.br

IMPORTANTE: Cat√°logo ficar√° acess√≠vel em TODAS as URLs configuradas,
mas o modo escolhido define qual URL ser√° compartilhada oficialmente.

=============================================================================
DNS - EXEMPLOS DE CONFIGURA√á√ÉO
=============================================================================

EXEMPLO 1: Registro.br
----------------------
1. Acesse painel.registro.br
2. Clique em "DNS"
3. Adicione:
   
   Registro TXT:
   _vendmais-verification  IN  TXT  "vendmais-abc123..."
   
   Registro CNAME:
   www  IN  CNAME  app.aoseudispor.com.br.

4. Salvar e aguardar

EXEMPLO 2: Cloudflare
---------------------
1. Dashboard ‚Üí DNS ‚Üí Add Record
2. Tipo: TXT
   Nome: _vendmais-verification
   Conte√∫do: vendmais-abc123...
   Proxy: DNS only (cinza)

3. Add Record
4. Tipo: CNAME
   Nome: www
   Alvo: app.aoseudispor.com.br
   Proxy: Proxied (laranja) ou DNS only (cinza)

5. Save

EXEMPLO 3: GoDaddy
------------------
1. My Products ‚Üí Domains ‚Üí DNS
2. Add ‚Üí TXT
   Host: _vendmais-verification
   TXT Value: vendmais-abc123...
   TTL: 1 Hour

3. Add ‚Üí CNAME
   Host: www
   Points to: app.aoseudispor.com.br
   TTL: 1 Hour

4. Save

=============================================================================
SSL - CONFIGURA√á√ÉO DETALHADA
=============================================================================

M√âTODO 1: Certbot + Nginx (Recomendado)
----------------------------------------
# 1. Instalar Certbot
sudo apt update
sudo apt install certbot python3-certbot-nginx

# 2. Gerar certificado
sudo certbot --nginx -d www.mirazzi.com.br

# 3. Certbot faz tudo automaticamente:
   - Gera certificado
   - Configura Nginx
   - Ativa HTTPS
   - Configura renova√ß√£o autom√°tica

# 4. Verificar renova√ß√£o autom√°tica
sudo certbot renew --dry-run

# 5. Verificar certificado
openssl s_client -connect www.mirazzi.com.br:443 -servername www.mirazzi.com.br

M√âTODO 2: Certbot Standalone
-----------------------------
# Se Nginx n√£o estiver rodando:
sudo certbot certonly --standalone -d www.mirazzi.com.br

# Certificados ficam em:
# /etc/letsencrypt/live/www.mirazzi.com.br/fullchain.pem
# /etc/letsencrypt/live/www.mirazzi.com.br/privkey.pem

# Configure manualmente no Nginx:
server {
    listen 443 ssl;
    server_name www.mirazzi.com.br;
    
    ssl_certificate /etc/letsencrypt/live/www.mirazzi.com.br/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/www.mirazzi.com.br/privkey.pem;
    
    # ... resto da configura√ß√£o
}

RENOVA√á√ÉO AUTOM√ÅTICA:
---------------------
Certbot adiciona entrada no cron/systemd:
/etc/cron.d/certbot

Para verificar:
sudo systemctl list-timers | grep certbot

For√ßar renova√ß√£o manual:
sudo certbot renew

=============================================================================
CONFIGURA√á√ÉO NO PAINEL ADMIN
=============================================================================

LOCALIZA√á√ÉO:
Configura√ß√µes do Cat√°logo > Aba "Dom√≠nios"

SE√á√ÉO 1: Modo de Acesso
------------------------
Radio buttons para escolher:
( ) Slug Tradicional - app.aoseudispor.com.br/catalog/[slug]
( ) Subdom√≠nio - [subdominio].aoseudispor.com.br
( ) Dom√≠nio Pr√≥prio - www.[seudominio].com.br

Este modo define qual URL ser√° usada em:
- Links compartilh√°veis
- QR Codes
- Integra√ß√£o WhatsApp
- Redes sociais

IMPORTANTE: Cat√°logo ficar√° acess√≠vel em TODAS as URLs configuradas,
mas o modo escolhido define a URL "oficial" compartilhada.

SE√á√ÉO 2: Configura√ß√£o de Subdom√≠nio
------------------------------------
Campo: Digite o subdom√≠nio desejado
Bot√£o: "Verificar" - Valida disponibilidade
Preview: Mostra URL completa
Switch: Habilitar/Desabilitar

Status:
‚úÖ Dispon√≠vel - pode usar
‚ùå Em uso - escolha outro
‚è≥ Verificando - aguarde

SE√á√ÉO 3: Configura√ß√£o de Dom√≠nio Pr√≥prio
-----------------------------------------
Campo: Digite dom√≠nio completo
Bot√£o: "Gerar Token" - Cria token √∫nico
Instru√ß√µes: Configura√ß√£o DNS detalhada
Bot√£o: "Verificar DNS" - Valida configura√ß√£o
Status: Pendente/Verificado/Falhou
Instru√ß√µes SSL: Comandos do certbot

Badge Verde "Verificado" = Pronto para usar
Badge Amarelo "Pendente" = Aguardando verifica√ß√£o
Badge Vermelho "Falhou" = Erro na verifica√ß√£o

SE√á√ÉO 4: Links Dispon√≠veis
---------------------------
Mostra todas URLs configuradas com:
- Bot√£o copiar
- Bot√£o abrir em nova aba
- Status de cada URL

=============================================================================
FLUXO COMPLETO - DOM√çNIO PR√ìPRIO
=============================================================================

TEMPO ESTIMADO: 30-60 minutos

1. REGISTRAR DOM√çNIO (se n√£o tiver)
   - Registro.br, GoDaddy, Namecheap, etc
   - Custo: R$ 40-80/ano

2. CONFIGURAR NO ADMIN (5 min)
   - Digite dom√≠nio
   - Gere token
   - Copie instru√ß√µes

3. CONFIGURAR DNS (10 min + propaga√ß√£o)
   - Adicione registro TXT
   - Adicione registro CNAME
   - Aguarde propaga√ß√£o (5-60 min)

4. VERIFICAR DNS (2 min)
   - Clique em "Verificar DNS"
   - Aguarde confirma√ß√£o

5. CONFIGURAR SSL (10 min)
   - Acesse servidor via SSH
   - Execute certbot
   - Teste HTTPS

6. ATIVAR (1 min)
   - Marque switch "Habilitar"
   - Selecione modo "Dom√≠nio Pr√≥prio"
   - Salve

7. VALIDAR (2 min)
   - Abra https://www.seudominio.com.br
   - Verifique cadeado verde (SSL)
   - Teste navega√ß√£o no cat√°logo

TOTAL: ~30 min de trabalho + 30-60 min de espera (DNS)

=============================================================================
MIGRANDO ENTRE MODOS
=============================================================================

DE SLUG PARA SUBDOM√çNIO:
1. Configure subdom√≠nio (dispon√≠vel imediatamente)
2. Teste o subdom√≠nio
3. Mude modo para "Subdom√≠nio"
4. Salve
5. Slug anterior continua funcionando (compatibilidade)

DE SUBDOM√çNIO PARA DOM√çNIO PR√ìPRIO:
1. Configure dom√≠nio pr√≥prio
2. Aguarde verifica√ß√£o DNS
3. Configure SSL
4. Mude modo para "Dom√≠nio Pr√≥prio"
5. Salve
6. Subdom√≠nio e slug continuam funcionando

ROLLBACK:
Se algo der errado, sempre pode voltar para "Slug"
que funciona sem configura√ß√£o adicional.

=============================================================================
CHECKLIST DE VALIDA√á√ÉO
=============================================================================

SUBDOM√çNIO:
[ ] Subdom√≠nio escolhido (sem caracteres especiais)
[ ] Verificado como dispon√≠vel
[ ] Switch "Habilitar" marcado
[ ] Modo "Subdom√≠nio" selecionado
[ ] Configura√ß√µes salvas
[ ] URL abre em aba an√¥nima
[ ] SSL ativo (cadeado verde)
[ ] Cat√°logo carrega corretamente

DOM√çNIO PR√ìPRIO:
[ ] Dom√≠nio registrado e ativo
[ ] Token de verifica√ß√£o gerado
[ ] Registro TXT adicionado no DNS
[ ] Registro CNAME/A adicionado no DNS
[ ] DNS propagado (verificar com dnschecker.org)
[ ] Verifica√ß√£o DNS passou (badge verde)
[ ] Certbot executado com sucesso
[ ] SSL ativo (https funciona)
[ ] Switch "Habilitar" marcado
[ ] Modo "Dom√≠nio Pr√≥prio" selecionado
[ ] Configura√ß√µes salvas
[ ] URL abre corretamente
[ ] Cat√°logo carrega sem erros

=============================================================================
SUPORTE T√âCNICO
=============================================================================

CONTATOS:
- Suporte DNS: Seu provedor de dom√≠nio
- Suporte SSL: https://letsencrypt.org/docs/
- Suporte Plataforma: suporte@aoseudispor.com.br

FERRAMENTAS √öTEIS:
- DNS Checker: https://dnschecker.org
- SSL Test: https://www.ssllabs.com/ssltest/
- Whois Lookup: https://registro.br/tecnologia/ferramentas/whois/

LOGS:
- DNS: /var/log/nginx/error.log
- SSL: /var/log/letsencrypt/letsencrypt.log
- Aplica√ß√£o: Console do navegador (F12)

=============================================================================
IMPLEMENTADO COM SUCESSO! üéâ
Sistema completo de dom√≠nios customizados
Slug + Subdom√≠nio + Dom√≠nio Pr√≥prio
=============================================================================

